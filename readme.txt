四字熟語.alfredworkflowのメモ

機能：
　難読四字熟語（　https://yattoke.com/2018/08/28/1g-yojijyukugo　）を表示する

インストール：
　1.alfredworkflowをダウンロード
　2.ファイルをダブルクリックしてワークフローに登録

使い方：
　キーワード『4ji』を入力するとランダムに難読四字熟語が表示されます
　サンプル動画『四字熟語.m4v』をご覧くださいな

開発メモ：

Lesson7などのパース系ワークフローから派生して作成しています

1.四字熟語のサイトを探す

　実は、この作業が一番苦労します。
　ランダム表示するのは母数が1000個程度は欲しいのですが、1ページでこれだけの数の情報を持っているものはなかなかありません。
　で、見つけたのがこのサイト。
　https://yattoke.com/2018/08/28/1g-yojijyukugo/
　
　このHPは四字熟語が、表になっています。
　HTMLをみるとシンプルに<tr>タグのなかに4つの<td>タグがあるだけですね
　　

2.HTMLをパースして、必要な情報を取り出す

　4つのタグの中身は下記の通り
  1つ目の<td>は通番
  1つ目の<td>は四字熟語
  1つ目の<td>は四字熟語のふりがな
  1つ目の<td>は四字熟語の意味

 
　上記<td>タグを配列に格納し、数字でコントロールするだけで上手くいきそうですね。
　4つの<td>が1組なので、四字熟語の件数(下のmax)は<td>タグの総数を4で割ればわかります。

　max=$((${#td[@]}/4))

  
　その中からランダムに9件抽出します。
　したのコードは、1から総数maxまで並べて、シャッフルして、頭の9件を配列ixに格納しています。　
　簡単ですね

　ix=(`seq 1 $max|shuf|head -n 9`)



3.JSON出力フォーマットのXMLを作成する

　せっかく通番があるので、uidも使いましたが、特になくてもOKです
　titleは、漢字の四字熟語：その四字熟語のふりがなとしました
　subtitleにはその四字熟語の意味
  linkは、四字熟語として、後続フローでデフォルトブラウザでの検索につなげています


背景：
 Lesson16『トリビアの泉のランダム表示』を作成したときに、四字熟語のランダム表示を思いつき作りました。
　


